import{_ as n,o as a,c as l,N as o}from"./chunks/framework.785526fc.js";const i=JSON.parse('{"title":"Chrome 扩展插件开发","description":"","frontmatter":{},"headers":[],"relativePath":"base/browser/chrome.md","lastUpdated":1725516172000}'),p={name:"base/browser/chrome.md"};function e(c,s,t,r,D,F){return a(),l("div",null,s[0]||(s[0]=[o(`<h1 id="chrome-扩展插件开发" tabindex="-1">Chrome 扩展插件开发 <a class="header-anchor" href="#chrome-扩展插件开发" aria-label="Permalink to &quot;Chrome 扩展插件开发&quot;">​</a></h1><p><code>Chrome</code> 扩展是用于扩充 <code>Chrome</code> 浏览器功能的程序。主要是对浏览器功能的增强，它更强调与浏览器相结合。比如 <code>Chrome</code> 扩展可以更改用户当前浏览的网页中的内容、获取 <code>Devtools</code> 中的信息、更改浏览器代理服务器的设置等等。</p><p><code>Chrome</code> 扩展是一系列文件的集合，这些文件包括<strong>HTML 文件</strong>、<strong>CSS 样式文件</strong>、<strong>JavaScript 脚本文件</strong>、<strong>图片等静态文件</strong>以及 <code>manifest.json</code> 清单文件。</p><p>🔗 <a href="https://developer.chrome.com/docs/extensions/mv3/" target="_blank" rel="noreferrer">Chrome 扩展程序官方文档</a></p><h2 id="扩展程序基本组成结构" tabindex="-1">扩展程序基本组成结构 <a class="header-anchor" href="#扩展程序基本组成结构" aria-label="Permalink to &quot;扩展程序基本组成结构&quot;">​</a></h2><p><img src="https://steinsgate.oss-cn-hangzhou.aliyuncs.com/chrome_ext_jiagou.jpg" alt="chrome_ext_jiagou"></p><p>扩展程序是通过『内容脚本』『浮层』『后台脚本』『<code>devtools</code> 信息』等合作通信去实现特定功能的后台程序。</p><h3 id="manifest-json" tabindex="-1"><code>manifest.json</code> <a class="header-anchor" href="#manifest-json" aria-label="Permalink to &quot;\`manifest.json\`&quot;">​</a></h3><p>扩展被安装后，<code>Chrome</code> 就会读取扩展中的 <code>manifest.json</code> 文件。这个文件的文件名固定为 <code>manifest.json</code>，内容是按照一定格式描述的扩展相关信息，如扩展名称、版本、更新地址、请求的权限、扩展的 <code>UI</code> 界面入口等等。这样 <code>Chrome</code> 就可以知道在浏览器中如何呈现这个扩展，以及这个扩展如何同用户进行交互。</p><p>自 2022 年 1 月 17 日起，<code>Chrome</code> 网上应用商店已停止接受新的 <code>Manifest V2</code> 扩展。<code>Manifest V2</code> 将于 2024 年逐步淘汰。</p><p><code>Manifest V3</code> 扩展在安全性、隐私和性能方面得到增强，因此后续我们将使用最新的 <code>V3</code> 版本。</p><p>下面列举部分配置，完整配置清单见官方：<a href="https://developer.chrome.com/docs/extensions/mv3/manifest/" target="_blank" rel="noreferrer">📃 Manifest 配置</a></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 基本信息</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">manifest_version</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// V3 版本</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">My Extension</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 插件名称</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">version</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0.1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 插件版本</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">A plain text description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;">// 插件描述</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">default_locale</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">en</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 默认语言</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">author</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">xxx</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 插件作者</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">   </span><span style="color:#676E95;font-style:italic;">// 用于配置点击插件图标后的浮层，popup.html 则是浮层的内容</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">action</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">     </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">default_title</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Click to view a popup</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 鼠标移动到扩展图标时显示 tooltip</span></span>
<span class="line"><span style="color:#BABED8;">     </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">default_popup</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">popup.html</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">   </span><span style="color:#89DDFF;">},</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">icons</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span><span style="color:#BABED8;">...</span><span style="color:#89DDFF;">},</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 插件图标配置</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// \`后台脚本\`，该脚本不能访问DOM，只能通过 \`消息传递\` 与扩展程序的其他部分进行通信，例如：\`内容脚本\`、\`浮层\`</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">background</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">service_worker</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">background.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// \`内容脚本\`，在网页中运行，可以访问DOM、获取页面上下文以及向页面中插入内容，通过 \`消息传递\` 与扩展程序的其他部分进行通信</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">content_scripts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#BABED8;">     </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">       </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">matches</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://*.nytimes.com/*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 指定此内容脚本被插入到哪些页面中</span></span>
<span class="line"><span style="color:#BABED8;">       </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">css</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">my-styles.css</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 要注入匹配页面的 CSS 文件列表</span></span>
<span class="line"><span style="color:#BABED8;">       </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">content-script.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 要注入匹配页面的 JavaScript 文件列表，按照数组的顺序注入（不支持网络路径）</span></span>
<span class="line"><span style="color:#BABED8;">       </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">run_at</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">document_idle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;">// 何时将 JavaScript 文件注入网页，可选址值：document_idle document_start document_end</span></span>
<span class="line"><span style="color:#BABED8;">     </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">   </span><span style="color:#89DDFF;">],</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 使用/添加devtools中的功能</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">devtools_page</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">devtools.html</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 插件设置页面</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">options_page</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">options.html</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">options_ui</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">chrome_style</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">true,</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">page</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">options.html</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 该插件可以访问的资源，后台脚本发送跨域请求需要配置该项</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">host_permissions</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://*/*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://*/*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 必需权限，扩展程序的基本功能所需的权限。 权限列表：https://developer.chrome.com/docs/extensions/mv2/declare_permissions/</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">permissions</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">storage</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// 可选权限，与 permissions 类似，但在扩展运行时授予，而不是提前授予</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">optional_permissions</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">downloads</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><h3 id="浮层-popup" tabindex="-1">浮层<code>(popup)</code> <a class="header-anchor" href="#浮层-popup" aria-label="Permalink to &quot;浮层\`(popup)\`&quot;">​</a></h3><p>点击插件图标后出现的浮层，<code>popup.html</code> 则是浮层的内容，可以在 <code>popup.html</code> 中引入 <code>JS</code> 文件，以用于与扩展其他部分进行交互。</p><p><img src="https://steinsgate.oss-cn-hangzhou.aliyuncs.com/chrome_popup.jpg" alt="chrome_popup"></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">My Extension</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">action</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">default_title</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Click to view a popup</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">default_popup</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">popup.html</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p><a href="https://developer.chrome.com/docs/extensions/reference/action/" target="_blank" rel="noreferrer">📃 action</a></p></blockquote><h3 id="后台脚本-service-worker" tabindex="-1">后台脚本<code>(service_worker)</code> <a class="header-anchor" href="#后台脚本-service-worker" aria-label="Permalink to &quot;后台脚本\`(service_worker)\`&quot;">​</a></h3><p>扩展程序使用 <code>service_worker</code> <strong>后台脚本</strong>来监视<strong>扩展程序的其他部分注册的事件</strong>，然后根据指定的指令做出反应。</p><p><code>service_worker</code> 后台脚本的特性：</p><ul><li>无法访问页面 <code>DOM</code>。</li><li>会一直处于休眠状态，直到它们正在侦听的事件触发，按照指定的指令做出反应，然后卸载。</li><li>可以发送跨域请求。</li></ul><blockquote><p><a href="https://developer.chrome.com/docs/extensions/mv3/service_workers/" target="_blank" rel="noreferrer">📃 service_worker</a></p></blockquote><h4 id="注册-service-worker" tabindex="-1">注册 <code>service_worker</code> <a class="header-anchor" href="#注册-service-worker" aria-label="Permalink to &quot;注册 \`service_worker\`&quot;">​</a></h4><p>在 <code>manifest.json</code> 清单文件的 <code>background</code> 字段配置一个 <code>JS</code> 文件以指定后台脚本：</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Awesome Test Extension</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">  ...</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">background</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">service_worker</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">background.js</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#BABED8;">  ...</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>还可以选择指定一个额外的字段，<code>&quot;type&quot;: &quot;module&quot;</code> 以让 <code>service_worker</code> 支持 <code>ES</code> 模块，这允许我们使用 <code>import</code>。例如：</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">background</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">: </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">service_worker</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">background.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">module</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>有关更多信息，参阅 <a href="https://web.dev/es-modules-in-sw/" target="_blank" rel="noreferrer">ES modules in service workers</a></p><h4 id="初始化扩展" tabindex="-1">初始化扩展 <a class="header-anchor" href="#初始化扩展" aria-label="Permalink to &quot;初始化扩展&quot;">​</a></h4><p>监听到 <code>chrome.runtime.onInstalled</code> 事件触发时表明插件安装完成。可以使用此事件设置状态或一次性初始化，例如设置右键菜单：</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">runtime</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">onInstalled</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addListener</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">contextMenus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">create</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    id</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">sampleContextMenu</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    title</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Sample Context Menu</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    contexts</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">selection</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="内容脚本-content-script" tabindex="-1">内容脚本<code>(content_script)</code> <a class="header-anchor" href="#内容脚本-content-script" aria-label="Permalink to &quot;内容脚本\`(content_script)\`&quot;">​</a></h3><p><strong>内容脚本</strong>是在网页上下文中运行的文件。通过使用标准文档对象模型<code>(DOM)</code>，他们能够读取浏览器访问的网页的详细信息<code>(DOM)</code>，对其进行更改，并将信息传递给扩展的其他部分。</p><p>此外，<strong>内容脚本</strong>只可以访问部分 <code>chrome API</code>：</p><ul><li><code>i18n</code></li><li><code>storage</code></li><li><code>runtime</code>: <ul><li><code>connect</code></li><li><code>getManifest</code></li><li><code>getURL</code></li><li><code>id</code></li><li><code>onConnect</code></li><li><code>onMessage</code></li><li><code>sendMessage</code></li></ul></li></ul><p><strong>内容脚本</strong>可以通过使用 <code>message API</code> 来与扩展的其他部分进行通信。</p><blockquote><p><a href="https://developer.chrome.com/docs/extensions/mv3/content_scripts/" target="_blank" rel="noreferrer">📃 content_script</a></p></blockquote><h4 id="注入方式" tabindex="-1">注入方式 <a class="header-anchor" href="#注入方式" aria-label="Permalink to &quot;注入方式&quot;">​</a></h4><p>内容脚本可以<strong>静态声明</strong>或以<strong>编程方式</strong>注入。</p><h5 id="使用静态声明注入" tabindex="-1">使用静态声明注入 <a class="header-anchor" href="#使用静态声明注入" aria-label="Permalink to &quot;使用静态声明注入&quot;">​</a></h5><p><code>manifest.json</code> 中的 <code>content_scripts</code> 字段声明用于应该在目标页面上自动运行的脚本。</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">My extension</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;"> ...</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">content_scripts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#BABED8;">   </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">     </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">matches</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://*.nytimes.com/*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#BABED8;">     </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">css</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">my-styles.css</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#BABED8;">     </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">content-script.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#BABED8;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#BABED8;"> ...</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="以编程方式注入" tabindex="-1">以编程方式注入 <a class="header-anchor" href="#以编程方式注入" aria-label="Permalink to &quot;以编程方式注入&quot;">​</a></h5><p>对需要在特定场合运行的<strong>内容脚本</strong>使用编程注入。</p><p>要以编程方式注入内容脚本，扩展程序要有 <code>activeTab</code> 权限，具体配置：</p><p><code>manifest.json:</code></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">My extension</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">  ...</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">permissions</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">activeTab</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;">// 声明 activeTab 权限</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">background</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">service_worker</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">background.js</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>content-script.js:</code></p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 修改页面背景色</span></span>
<span class="line"><span style="color:#BABED8;">document</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">body</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">style</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">backgroundColor </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">orange</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>background.js:</code></p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">action</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">onClicked</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addListener</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">tab</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 点击扩展图标时动态注入内容脚本</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">scripting</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeScript</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    target</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> tabId</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">tab</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">id</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">    files</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">content-script.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>或者函数体也可以作为内容脚本注入和执行：</p><p><code>background.js:</code></p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">injectedFunction</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">document</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">body</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">style</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">backgroundColor</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">orange</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">action</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">onClicked</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addListener</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">tab</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 点击扩展图标时动态注入内容脚本</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">scripting</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeScript</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    target</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> tabId</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">tab</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">id</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 直接运行函数</span></span>
<span class="line"><span style="color:#F07178;">    func</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">injectedFunction</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="配置页面-options-page" tabindex="-1">配置页面<code>(options_page)</code> <a class="header-anchor" href="#配置页面-options-page" aria-label="Permalink to &quot;配置页面\`(options_page)\`&quot;">​</a></h3><p>提供配置页面来允许用户自定义扩展程序的功能。</p><p>几种跳转到扩展程序配置页面的方法：</p><ul><li>通过 <strong>右键单击工具栏</strong> 中的扩展程序图标然后选择 <strong>选项</strong>；</li><li>导航栏输入 <code>chrome://extensions</code> 跳转到扩展程序管理页面，然后点击目标扩展程序的「详情」-「扩展程序选项」；</li><li>在扩展程序内调用 <code>chrome.runtime.openOptionsPage()</code> API。</li></ul><blockquote><p><a href="https://developer.chrome.com/docs/extensions/mv3/options/" target="_blank" rel="noreferrer">📃 options_page</a></p></blockquote><h3 id="devtools-devtools-page" tabindex="-1"><code>DevTools(devtools_page)</code> <a class="header-anchor" href="#devtools-devtools-page" aria-label="Permalink to &quot;\`DevTools(devtools_page)\`&quot;">​</a></h3><p>扩展程序的 <code>DevTools</code> 为 <code>Chrome DevTools</code> 添加了功能。它可以添加新的 <code>UI</code> 面板和侧边栏，与唤出 <code>DevTools</code> 的页面交互（打开 <code>F12</code> 的页面），获取有关网络请求的信息等等。<code>DevTools</code> 扩展可以访问一组额外的 <code>DevTools</code> 特定扩展 <code>API</code>：</p><ul><li><code>devtools.inspectedWindow</code> 获取<strong>被检查页面</strong>的选项卡 <code>ID</code>、上下文代码、获取页面内的资源列表。</li><li><code>devtools.network</code> 检索网络面板中开发者工具显示的网络请求信息。</li><li><code>devtools.panels</code> 将的扩展的 <code>DevTools</code> 集成到开发人员工具窗口 <code>UI</code> 中：创建自己的面板、访问现有面板并添加侧边栏。</li></ul><p><code>Devtools</code> 在扩展程序架构中的体现：</p><p><img src="https://steinsgate.oss-cn-hangzhou.aliyuncs.com/chrome_ext_devtools.png" alt="chrome_ext_devtools.png"></p><blockquote><p><a href="https://developer.chrome.com/docs/extensions/mv3/devtools/" target="_blank" rel="noreferrer">📃 DevTools</a></p></blockquote><h2 id="消息传递" tabindex="-1">消息传递 <a class="header-anchor" href="#消息传递" aria-label="Permalink to &quot;消息传递&quot;">​</a></h2><p>由于<strong>内容脚本</strong><code>(content_script)</code>在网页上下文而不是扩展程序的上下文中运行，因此它们通常需要某种方式与扩展程序的其余部分进行通信。</p><p><strong>内容脚本</strong>和扩展程序其他部分的通信通过使用<strong>消息传递</strong>进行。任何一方都可以侦听从另一端发送的消息，并在同一通道上响应。消息可以包含任何有效的 <code>JSON</code> 对象（<code>null</code>, <code>boolean</code>, <code>number</code>, <code>string</code>, <code>array</code>, <code>object</code>）。</p><p>有一个用于<strong>一次性请求</strong>的 <code>API</code> 和一个<strong>建立长期连接</strong>API（它允许在共享上下文中交换多条消息的长连接。如果知道另一个扩展的 ID，也可以向另一个扩展发送消息）。</p><blockquote><p><a href="https://developer.chrome.com/docs/extensions/mv3/messaging/" target="_blank" rel="noreferrer">📃 消息传递</a></p></blockquote><h3 id="一次性请求" tabindex="-1">一次性请求 <a class="header-anchor" href="#一次性请求" aria-label="Permalink to &quot;一次性请求&quot;">​</a></h3><p>如果只需要向扩展程序的另一部分(内容脚本或后台脚本)发送一条消息（并且可以选择返回响应），应该使用简化的 <code>runtime.sendMessage</code> 或 <code>tabs.sendMessage</code>。这可以将一次性 <code>JSON</code> 可序列化消息从<strong>内容脚本</strong>发送到<strong>后台脚本</strong>或其他部分，反之亦然。可选的回调参数允许我们处理来自另一侧的响应（如果有）。</p><p>从内容脚本发送请求如下所示：</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">runtime</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sendMessage</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">{</span><span style="color:#BABED8;"> </span><span style="color:#F07178;">greeting</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">},</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">response</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">response</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">farewell</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在接收端，需要设置一个 <code>runtime.onMessage</code> 事件侦听器来处理消息：</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">runtime</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">onMessage</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addListener</span><span style="color:#BABED8;">(</span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">request</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">sender</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">sendResponse</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 有 sender.tab 说明是从 内容脚本 发过来的，否则就是从其他部分发过来的</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">sender</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">tab</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">?</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">from a content script:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">sender</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">tab</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">url</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">from the extension</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">request</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">greeting</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#82AAFF;">sendResponse</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> farewell</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">goodbye</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>从<strong>扩展程序其他部分</strong>向<strong>内容脚本</strong>发送请求看起来非常相似，只是需要指定将请求发送到哪个选项卡：</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">tabs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">query</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">{</span><span style="color:#BABED8;"> </span><span style="color:#F07178;">active</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F07178;">currentWindow</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">},</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">tabs</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 向当前浏览器窗口正在激活的 tab 页面发送消息</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">tabs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sendMessage</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">tabs</span><span style="color:#F07178;">[</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">id</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> greeting</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">response</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">response</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">farewell</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="长期连接" tabindex="-1">长期连接 <a class="header-anchor" href="#长期连接" aria-label="Permalink to &quot;长期连接&quot;">​</a></h4><p>有时，我们可能需求建立一个长会话。在这种情况下，可以使用 <code>runtime.connect</code> 或 <code>tabs.connect</code> 打开一个从内容脚本到<strong>其他部分</strong>的长期通道，反之亦然。通道可以有一个可选的名称，允许我们区分不同类型的连接。</p><blockquote><p>有关建立长连接的更多信息，参阅：<a href="https://developer.chrome.com/docs/extensions/mv3/messaging/#connect" target="_blank" rel="noreferrer">长期连接</a></p></blockquote><h2 id="开发调试" tabindex="-1">开发调试 <a class="header-anchor" href="#开发调试" aria-label="Permalink to &quot;开发调试&quot;">​</a></h2><ul><li><p><code>popup</code> 右键扩展图标，选择<strong>审查弹出内容</strong>，会弹出控制台</p></li><li><p><code>service_worker</code> 有一个专属的控制台，可以在那里查看打印信息</p></li><li><p><code>content_script</code> 直接在页面控制台查看信息</p></li><li><p><code>devtools</code> 在此页面打开 <code>F12</code> 进行调试 <code>chrome-extension://{扩展ID}/devtools/index.html</code>，扩展 <code>ID</code> 查看，或者在【扩展管理】-【详情】-【查看视图】找到对应扩展的调试窗口地址。</p></li></ul><h2 id="踩坑记录" tabindex="-1">踩坑记录 <a class="header-anchor" href="#踩坑记录" aria-label="Permalink to &quot;踩坑记录&quot;">​</a></h2><h3 id="无法为内容脚本加载-javascript。-无法加载清单" tabindex="-1">无法为内容脚本加载 <code>JavaScript</code>。 无法加载清单 <a class="header-anchor" href="#无法为内容脚本加载-javascript。-无法加载清单" aria-label="Permalink to &quot;无法为内容脚本加载 \`JavaScript\`。 无法加载清单&quot;">​</a></h3><p>出现此错误可能有多种原因，一般都是 <code>manifest.json</code> 中的配置项有问题，可以排查下列属性：</p><ul><li><code>content_scripts</code> 中的 <code>js</code> 不能使用网络路径</li><li><code>default_locale</code> 配置为 <code>zh_CN</code> 后需要在根目录下新建 <code>_locales</code> 语言包目录</li><li>将需要在外部使用的资源列到 <code>web_accessible_resources</code> 属性中</li></ul><h3 id="unchecked-runtime-lasterror-this-function-must-be-called-during-a-user-gesture" tabindex="-1"><code>Unchecked runtime.lastError: This function must be called during a user gesture</code> <a class="header-anchor" href="#unchecked-runtime-lasterror-this-function-must-be-called-during-a-user-gesture" aria-label="Permalink to &quot;\`Unchecked runtime.lastError: This function must be called during a user gesture\`&quot;">​</a></h3><ul><li>未经检查的 <code>runtime.lastError</code>：必须在用户手势期间调用此函数</li></ul><p>由脚本自动触发的动态获取权限，而不是由用户的点击事件触发，解决办法：</p><ul><li>将动态权限改成固定权限。</li></ul><h3 id="unchecked-runtime-lasterror-the-message-port-closed-before-a-response-was-received" tabindex="-1"><code>Unchecked runtime.lastError: The message port closed before a response was received</code> <a class="header-anchor" href="#unchecked-runtime-lasterror-the-message-port-closed-before-a-response-was-received" aria-label="Permalink to &quot;\`Unchecked runtime.lastError: The message port closed before a response was received\`&quot;">​</a></h3><ul><li>未经检查的 <code>runtime.lastError</code>：消息端口在收到响应之前关闭</li></ul><p>这种问题是在调用 <code>chrome.runtime.sendMessage</code> 时添加了回调，但是在接受消息端没有调用回传消息方法导致的：</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 发送端</span></span>
<span class="line"><span style="color:#BABED8;">chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">runtime</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sendMessage</span><span style="color:#BABED8;">(</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">action</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">server</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">source</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">response</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">alert</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">response</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">text</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 接收端</span></span>
<span class="line"><span style="color:#BABED8;">chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">extension</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">onMessage</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addListener</span><span style="color:#BABED8;">(</span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">request</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">sender</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">sendResponse</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">request</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">action</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">server</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">request</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 这里不调用 sendResponse 回传消息</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>解决办法：</p><ul><li>发送端去掉回调方法或者接收端调用回调方法。</li></ul><h3 id="extension-context-invalidated" tabindex="-1"><code>Extension context invalidated</code> <a class="header-anchor" href="#extension-context-invalidated" aria-label="Permalink to &quot;\`Extension context invalidated\`&quot;">​</a></h3><ul><li>扩展上下文无效</li></ul><p>当在扩展管理中心刷新或更新了某扩展，然后切换到浏览器某标签页的页面中直接使用该扩展时，扩展可能报错 <code>Extension context invalidated</code>。</p><p>报错位置可能在 <code>devtools/index.js</code> 里的 <code>&quot;chrome.runtime.sendMessage()&quot;</code> 部分。</p><p>处理方式：</p><ol><li>在更新了扩展后，使用扩展前，首先刷新相关页面</li><li>使用 <code>chrome.runtime.id</code> 判断扩展上下文是否有效，然后再执行 <code>chrome.runtime.sendMessage()</code></li></ol><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">runtime</span><span style="color:#89DDFF;">?.</span><span style="color:#BABED8;">id </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#BABED8;"> chrome</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">runtime</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sendMessage</span><span style="color:#BABED8;">()</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="devtools-中使用-chrome-devtools-network-onrequestfinished-addlistener-获取不到网络请求" tabindex="-1"><code>devtools</code> 中使用 <code>chrome.devtools.network.onRequestFinished.addListener</code> 获取不到网络请求 <a class="header-anchor" href="#devtools-中使用-chrome-devtools-network-onrequestfinished-addlistener-获取不到网络请求" aria-label="Permalink to &quot;\`devtools\` 中使用 \`chrome.devtools.network.onRequestFinished.addListener\` 获取不到网络请求&quot;">​</a></h3><p>不要直接打开 <code>devtools</code> 面板刷新页面，要刷新页面后再打开 <code>devtools</code> 面板再请求接口。</p><h2 id="发布扩展" tabindex="-1">发布扩展 <a class="header-anchor" href="#发布扩展" aria-label="Permalink to &quot;发布扩展&quot;">​</a></h2><ul><li>发布到 <code>Chrome</code> 应用商店（需要$5 注册费），地址：<a href="https://chrome.google.com/webstore/devconsole" target="_blank" rel="noreferrer">https://chrome.google.com/webstore/devconsole</a></li><li>在【扩展管理】页面打包本地的扩展程序，将打包出来的 <code>.crx</code> 文件拖入 <code>Chrome</code> 即可安装。</li></ul><blockquote><p>但是现在 <code>Chrome</code> 已经不允许使用未在 <code>Chrome</code> 应用商店中发布的扩展程序，安装后会提示 <em>该扩展程序未列在 <code>Chrome</code> 应用商店中，并可能是在您不知情的情况下添加的。</em> 参阅：<a href="https://support.google.com/chrome_webstore/answer/2811969?visit_id=638048013328104701-2621356661&amp;p=ui_remove_non_cws_extensions&amp;hl=zh-Hans&amp;rd=2" target="_blank" rel="noreferrer">Chrome 停用的扩展程序</a></p></blockquote>`,110)]))}const d=n(p,[["render",e]]);export{i as __pageData,d as default};
