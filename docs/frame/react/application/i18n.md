# react å®ç°å›½é™…åŒ–

åœ¨æˆ‘ä»¬å¹³æ—¶å¼€å‘é¡¹ç›®æ—¶ä¼šé‡åˆ°æ”¯æŒå›½é™…åŒ–çš„éœ€æ±‚ï¼Œæˆ‘ä»¬çš„åº”ç”¨éœ€è¦æ”¯æŒå¤šç§è¯­è¨€ã€‚

é‚£å¦‚ä½•å®ç°è¿™ç§å›½é™…åŒ–çš„éœ€æ±‚å‘¢ï¼Œå°±æ˜¯ç”¨ `react-i18next` æˆ–è€… `react-intl` è¿™ä¸ªåŒ…ã€‚

::: info ç›¸å…³èµ„æ–™

- `react-i18next`

  - [<u>react-i18next ï½œ npm åŒ…</u>](https://www.npmjs.com/package/react-i18next)

  - [<u>react-i18next ï½œ å®˜æ–¹æ–‡æ¡£</u>](https://react.i18next.com/)

  - [<u>react-i18next ï½œ GitHub</u>](https://github.com/i18next/react-i18next)

- `react-intl`

  - [<u>react-intl ï½œ npm åŒ…</u>](https://www.npmjs.com/package/react-intl)

  - [<u>react-intl ï½œ å®˜æ–¹æ–‡æ¡£</u>](https://formatjs.io/docs/getting-started/installation/)

  - [<u>react-intl ï½œ GitHub</u>](https://github.com/formatjs/formatjs)

:::

## react-intl

### å®‰è£… react-intl

```bash
npm i react-intl
```

### `IntlProvider`

- `IntlProvider`æ­¤ç»„ä»¶ç”¨äºä¸ºæ ‘è®¾ç½® `i18n` ä¸Šä¸‹æ–‡ã€‚é€šå¸¸ï¼Œæ­¤ç»„ä»¶å°†åŒ…è£…åº”ç”¨ç¨‹åºçš„æ ¹ç»„ä»¶ï¼Œä»¥ä¾¿æ•´ä¸ªåº”ç”¨ç¨‹åºå°†ä½äºé…ç½®çš„ `i18n` ä¸Šä¸‹æ–‡ä¸­

- `messages` é…ç½®è¯­è¨€åŒ…

- `locale` é…ç½®å½“å‰è¯­è¨€ï¼Œ[<u>`navigator.language`</u>](<[navigator.language](https://developer.mozilla.org/zh-CN/docs/Web/API/Navigator/language)>)ï¼Œè¡¨ç¤ºç”¨æˆ·çš„é¦–é€‰è¯­è¨€

> ä¸¾ä¸ª ğŸŒ°

```tsx
import ReactDOM from 'react-dom/client'
import { IntlProvider } from 'react-intl'

import App from './App'

import enUS from './en-US.json'
import zhCN from './zh-CN.json'

const messages: Record<string, any> = {
  'en-US': enUS,
  'zh-CN': zhCN,
}

const locale = navigator.language

ReactDOM.createRoot(document.getElementById('root')!).render(
  <IntlProvider messages={messages[locale]} locale={locale} defaultLocale="zh_CN">
    <App />
  </IntlProvider>,
)
```

### `defineMessages` å®šä¹‰æ¶ˆæ¯

å®šä¹‰ç»„ä»¶ä¸­çš„éœ€è¦ç¿»è¯‘çš„æ¡ç›®

```js
const messages = defineMessages({
  username: {
    id: 'username',
    defaultMessage: 'ç”¨æˆ·å',
  },
})
```

### `useIntl`

`useIntl` æä¾›äº†ç»„ä»¶å†…éƒ¨è®¿é—® `react-intl` çš„ `Intl` å®ä¾‹çš„æ–¹å¼ã€‚é€šè¿‡ `useIntl`ï¼Œä½ å¯ä»¥ä½¿ç”¨å„ç§ä¸å›½é™…åŒ–ç›¸å…³çš„å·¥å…·å‡½æ•°ï¼Œæ¯”å¦‚ `formatMessage`ã€`formatNumber`ã€`formatDate` ç­‰

```tsx
const App: React.FC = () => {
  const intl = useIntl()

  return <div>{intl.formatMessage(messages.username)}</div>
}
```

### `createIntl`

åœ¨éç»„ä»¶é‡Œç”¨ï¼Œè¦ç”¨ `createIntl`

```ts
import { createIntl, defineMessages } from 'react-intl'
import enUS from './en-US.json'
import zhCN from './zh-CN.json'

const messages: Record<string, any> = {
  'en-US': enUS,
  'zh-CN': zhCN,
}

const locale = navigator.language
const intl = createIntl({
  locale: locale,
  messages: messages[locale],
})

const defines = defineMessages({
  username: {
    id: 'username',
    defaultMessage: 'ç”¨æˆ·å',
  },
})

export default function () {
  return intl.formatMessage(defines.username)
}
```

### `message` æä¾›æ’å€¼è¡¨è¾¾å¼

```json
{
  "username": "ç”¨æˆ·å {name}",
  "age": "å¹´é¾„ <strong>{age}</strong>"
}
```

ä½¿ç”¨ï¼š

```ts
{
  intl.formatMessage(messages.username, { name: 'steinsGate' })
}
```

```tsx
<IntlProvider
  messages={messages[locale]}
  locale={locale}
  defaultLocale="zh_CN"
  defaultRichTextElements={{
    strong: (str) => <strong>{str}</strong>,
  }}
>
  <App />
</IntlProvider>
```

### `@formatjs/cli` è‡ªåŠ¨ç”Ÿæˆèµ„æºåŒ…

- ä»æ‰€æœ‰`.tsx`ç»“å°¾çš„æ–‡ä»¶é‡Œæå–æ‰€æœ‰ `defineMessage` å®šä¹‰çš„æ¶ˆæ¯

```sh
npx formatjs extract "src/**/*.tsx" --out-file define.json
```

- æ‰§è¡Œ `compile` å‘½ä»¤ç”Ÿæˆèµ„æºåŒ… `xxx.json`

```sh
npx formatjs compile 'define.json' --out-file src/locales/xxx.json
```

## react-i18next

### å®‰è£…

```bash
npm i i18next react-i18next
```

### é…ç½®

```js
import i18n from 'i18next'
import { initReactI18next } from 'react-i18next'

import zhTranslation from './locales/zh.json'
import enTranslation from './locales/en.json'

i18n
  // å°† i18n å®ä¾‹ä¼ é€’ç»™ react-i18next
  .use(initReactI18next)
  // åˆå§‹åŒ– i18next
  .init({
    fallbackLng: 'zh_CN', // é»˜è®¤å½“å‰ç¯å¢ƒçš„è¯­è¨€
    debug: true,
    interpolation: {
      escapeValue: false,
    },
    resources: {
      en: { translation: enTranslation },
      zh_CN: { translation: zhTranslation },
    },
  })

export default i18n
```

### `useTranslation`

```tsx
import { useTranslation } from 'react-i18next'

const { t } = useTranslation()

<div>t('welcome')</div>
```
