import{_ as n,o as a,c as l,N as p}from"./chunks/framework.0450e108.js";const D=JSON.parse('{"title":"æµè§ˆå™¨ç›¸å…³çš„ API","description":"","frontmatter":{},"headers":[],"relativePath":"base/browser/api.md","lastUpdated":1727115187000}'),e={name:"base/browser/api.md"};function o(r,s,t,c,F,y){return a(),l("div",null,s[0]||(s[0]=[p(`<h1 id="æµè§ˆå™¨ç›¸å…³çš„-api" tabindex="-1">æµè§ˆå™¨ç›¸å…³çš„ API <a class="header-anchor" href="#æµè§ˆå™¨ç›¸å…³çš„-api" aria-label="Permalink to &quot;æµè§ˆå™¨ç›¸å…³çš„ API&quot;">â€‹</a></h1><h2 id="requestidlecallback" tabindex="-1">requestIdleCallback <a class="header-anchor" href="#requestidlecallback" aria-label="Permalink to &quot;requestIdleCallback&quot;">â€‹</a></h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestIdleCallback" target="_blank" rel="noreferrer"><u>MDN requestIdleCallback API ğŸš€</u></a></p><ul><li>æˆ‘ä»¬å¸Œæœ›å¿«é€Ÿå“åº”ç”¨æˆ·ï¼Œè®©ç”¨æˆ·è§‰å¾—å¤Ÿå¿«ï¼Œä¸èƒ½é˜»å¡ç”¨æˆ·çš„äº¤äº’ã€‚</li><li><code>requestIdleCallback</code> ä½¿å¼€å‘è€…èƒ½å¤Ÿåœ¨ä¸»äº‹ä»¶å¾ªç¯ä¸Šæ‰§è¡Œåå°å’Œä½ä¼˜å…ˆçº§å·¥ä½œï¼Œè€Œä¸ä¼šå½±å“å»¶è¿Ÿå…³é”®äº‹ä»¶ï¼Œå¦‚åŠ¨ç”»å’Œè¾“å…¥å“åº”ã€‚</li><li>æ­£å¸¸å¸§ä»»åŠ¡å®Œæˆåæ²¡è¶…è¿‡ 16.6 msï¼Œè¯´æ˜æ—¶é—´æœ‰å¯Œä½™ï¼Œæ­¤æ—¶å°±ä¼šæ‰§è¡Œ <code>requestIdleCallback</code> é‡Œæ³¨å†Œçš„ä»»åŠ¡ã€‚</li></ul><p><img src="https://steinsgate.oss-cn-hangzhou.aliyuncs.com/requestIdleCallback.jpeg" alt="requestIdleCallback"></p><p>ç¼ºç‚¹ï¼š</p><ol><li>å…¼å®¹æ€§é—®é¢˜ã€‚</li><li>æ‰§è¡Œä»»åŠ¡çš„å¸§ç©ºé—²æ—¶é—´ä¸å¯æ§ï¼ˆ<code>React</code> è‡ªå·±å®ç°äº†ä¸€ä¸ª <code>requestIdleCallback</code>ï¼‰ã€‚</li><li>ä¸€ä¸ªä»»åŠ¡å°±æ˜¯æœ€å°çš„æ‰§è¡Œå•ä½ï¼Œä¸èƒ½è¢«æ‰“æ–­ï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¼šè¢«å¡ä½ã€‚</li></ol><blockquote><p>ä¸¾ä¸ªä¾‹å­ ğŸŒ°</p></blockquote><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;!</span><span style="color:#F07178;">DOCTYPE</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">html</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">html</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">lang</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">en</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">head</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">meta</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">charset</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">meta</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">http-equiv</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">X-UA-Compatible</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">content</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">IE=edge</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">meta</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">viewport</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">content</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">width=device-width, initial-scale=1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">title</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">requestIdleCallback</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">title</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">head</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">body</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">    &lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">sleep</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">duration</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">t</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">Date</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">now</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">Date</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">now</span><span style="color:#F07178;">() </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">t</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">duration</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> ) </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> works </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> [</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ç¬¬1ä¸ªä»»åŠ¡å¼€å§‹</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// ä»»åŠ¡æ‰§è¡Œæ—¶é—´å°‘è¿‡å½“å‰å¸§çš„ç©ºä½™æ—¶é—´ï¼Œå°±ä¼šç­‰å¾…å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œå½“å‰å¸§æ‰ä¼šç»“æŸ</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">sleep</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1000</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ç¬¬1ä¸ªä»»åŠ¡ç»“æŸ</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ç¬¬2ä¸ªä»»åŠ¡å¼€å§‹</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">sleep</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">20</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ç¬¬2ä¸ªä»»åŠ¡ç»“æŸ</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ç¬¬3ä¸ªä»»åŠ¡å¼€å§‹</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">sleep</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">20</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ç¬¬3ä¸ªä»»åŠ¡ç»“æŸ</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#BABED8;">      ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#82AAFF;">requestIdleCallback</span><span style="color:#BABED8;">(workLoop)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">workLoop</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">deadline</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//å› ä¸ºä¸€å¸§æ˜¯16.6msï¼Œæµè§ˆå™¨æ‰§è¡Œå®Œé«˜ä¼˜å…ˆçº§ä¹‹åï¼Œå¦‚æœè¿˜æœ‰æ—¶é—´ï¼Œä¼šæ‰§è¡ŒworkLoop,timeRemainingè·å–æ­¤å¸§å‰©ä¸‹çš„æ—¶é—´</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">æœ¬å¸§çš„å‰©ä½™æ—¶é—´æ˜¯</span><span style="color:#89DDFF;">\`</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">deadline</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">timeRemaining</span><span style="color:#F07178;">())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//å¦‚æœæ²¡æœ‰å‰©ä½™æ—¶é—´äº†ï¼Œå°±ä¼šè·³å‡ºå¾ªç¯</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">deadline</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">timeRemaining</span><span style="color:#F07178;">() </span><span style="color:#89DDFF;">&gt;</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">works</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// è¿˜æœ‰ç©ºé—²æ—¶é—´ &amp;&amp; è¿˜æœ‰ä»»åŠ¡æ²¡æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">performUnitOfWork</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//å¦‚æœè¿˜æœ‰å‰©ä½™ä»»åŠ¡</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">works</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">åªå‰©ä¸‹</span><span style="color:#89DDFF;">\${</span><span style="color:#BABED8;">deadline</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">timeRemaining</span><span style="color:#BABED8;">()</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">msï¼Œä¸å¤Ÿäº†ï¼Œç­‰å¾…æµè§ˆå™¨ä¸‹æ¬¡ç©ºé—² çš„æ—¶å€™å†å¸®æˆ‘è°ƒç”¨</span><span style="color:#89DDFF;">\`</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          )</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">requestIdleCallback</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">workLoop</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">performUnitOfWork</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//å–å‡ºä»»åŠ¡æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶ç§»é™¤ç¬¬ä¸€ä¸ªä»»åŠ¡</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">work</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">works</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">shift</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">work</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">body</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">html</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><div class="language-lua line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> æœ¬å¸§çš„å‰©ä½™æ—¶é—´æ˜¯ </span><span style="color:#F78C6C;">5.4</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> ç¬¬1ä¸ªä»»åŠ¡å¼€å§‹</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> ç¬¬1ä¸ªä»»åŠ¡ç»“æŸ</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> åªå‰©ä¸‹0msï¼Œä¸å¤Ÿäº†ï¼Œç­‰å¾…æµè§ˆå™¨ä¸‹æ¬¡ç©ºé—² çš„æ—¶å€™å†å¸®æˆ‘è°ƒç”¨</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> æœ¬å¸§çš„å‰©ä½™æ—¶é—´æ˜¯ </span><span style="color:#F78C6C;">3.3</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> ç¬¬2ä¸ªä»»åŠ¡å¼€å§‹</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> ç¬¬2ä¸ªä»»åŠ¡ç»“æŸ</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> åªå‰©ä¸‹0msï¼Œä¸å¤Ÿäº†ï¼Œç­‰å¾…æµè§ˆå™¨ä¸‹æ¬¡ç©ºé—² çš„æ—¶å€™å†å¸®æˆ‘è°ƒç”¨</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> æœ¬å¸§çš„å‰©ä½™æ—¶é—´æ˜¯ </span><span style="color:#F78C6C;">50</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> ç¬¬3ä¸ªä»»åŠ¡å¼€å§‹</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> ç¬¬3ä¸ªä»»åŠ¡ç»“æŸ</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">ç¼ºç‚¹</p><ul><li>å…¼å®¹æ€§é—®é¢˜ <a href="https://caniuse.com/?search=requestIdleCallback" target="_blank" rel="noreferrer"><u>requestIdleCallback çš„å…¼å®¹æ€§ ğŸš€</u></a>ã€‚</li><li>æ‰§è¡Œä»»åŠ¡çš„å¸§ç©ºé—²æ—¶é—´ä¸å¯æ§ã€‚</li></ul></div><h2 id="requestanimationframe" tabindex="-1">requestAnimationFrame <a class="header-anchor" href="#requestanimationframe" aria-label="Permalink to &quot;requestAnimationFrame&quot;">â€‹</a></h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/window/requestAnimationFrame" target="_blank" rel="noreferrer"><u>MDN requestAnimationFrame API ğŸš€</u></a></p><p><code>requestAnimationFrame</code> æ˜¯ HTML5 æä¾›çš„ä¸€ç§ APIï¼Œç”¨äºåœ¨æµè§ˆå™¨çš„ä¸‹ä¸€æ¬¡é‡ç»˜ä¹‹å‰æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚å®ƒæ˜¯ç”¨äºä¼˜åŒ–åŠ¨ç”»æ•ˆæœçš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ å®ç°æ›´åŠ æµç•…ã€é«˜æ•ˆçš„åŠ¨ç”»ã€‚ç›¸æ¯”äºä¼ ç»Ÿçš„ <code>setTimeout</code> æˆ– <code>setInterval</code> æ¥æ§åˆ¶åŠ¨ç”»å¸§çš„æ›´æ–°ï¼Œ<code>requestAnimationFrame</code> æ›´åŠ ç²¾ç¡®ï¼Œå› ä¸ºå®ƒå¯ä»¥æ ¹æ®æµè§ˆå™¨çš„åˆ·æ–°é¢‘ç‡æ¥è°ƒæ•´åŠ¨ç”»çš„èŠ‚å¥ï¼Œä»è€Œé¿å…æ‰å¸§æˆ–è€…å¡é¡¿ã€‚</p><blockquote><p>ä¸¾ä¸ªä¾‹å­ ğŸŒ°</p></blockquote><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">let</span><span style="color:#BABED8;"> start</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">step</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">timestamp</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#BABED8;">start</span><span style="color:#F07178;">) </span><span style="color:#BABED8;">start</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">timestamp</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// è®°å½•èµ·å§‹æ—¶é—´</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">progress</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">timestamp</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">start</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// è®¡ç®—å·²ç»è¿‡å»çš„æ—¶é—´</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">element</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">box</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// æ§åˆ¶ box çš„æ°´å¹³ç§»åŠ¨ï¼Œéšç€æ—¶é—´å‰è¿›</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">element</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">style</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">transform</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">translateX(</span><span style="color:#89DDFF;">\${</span><span style="color:#BABED8;">Math</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">min</span><span style="color:#BABED8;">(progress </span><span style="color:#89DDFF;">/</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">200</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">px)</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¦‚æœåŠ¨ç”»æœªå®Œæˆï¼Œç»§ç»­è°ƒç”¨ requestAnimationFrame</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">progress</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2000</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">requestAnimationFrame</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">step</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// å¯åŠ¨åŠ¨ç”»</span></span>
<span class="line"><span style="color:#82AAFF;">requestAnimationFrame</span><span style="color:#BABED8;">(step)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li><strong><code>timestamp</code></strong>ï¼š<code>requestAnimationFrame</code> çš„å›è°ƒå‡½æ•°æ¥æ”¶ä¸€ä¸ªå‚æ•° <code>timestamp</code>ï¼Œè¿™ä¸ªå‚æ•°æ˜¯æµè§ˆå™¨ä¼ é€’çš„å½“å‰å›è°ƒå‡½æ•°æ‰§è¡Œçš„æ—¶é—´ç‚¹ã€‚å®ƒè¡¨ç¤ºè‡ªé¡µé¢åŠ è½½å®Œæˆä»¥æ¥çš„æ¯«ç§’æ•°ï¼Œå¯ä»¥ç”¨æ¥è®¡ç®—åŠ¨ç”»è¿›è¡Œçš„æ—¶é—´ã€‚</li></ul><h3 id="å¦‚ä½•å–æ¶ˆ-requestanimationframe" tabindex="-1">å¦‚ä½•å–æ¶ˆ <code>requestAnimationFrame</code> <a class="header-anchor" href="#å¦‚ä½•å–æ¶ˆ-requestanimationframe" aria-label="Permalink to &quot;å¦‚ä½•å–æ¶ˆ \`requestAnimationFrame\`&quot;">â€‹</a></h3><p>ä½ å¯ä»¥ä½¿ç”¨ <code>cancelAnimationFrame</code> æ¥åœæ­¢åŠ¨ç”»çš„æ‰§è¡Œï¼š</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">let</span><span style="color:#BABED8;"> animationId </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">requestAnimationFrame</span><span style="color:#BABED8;">(step)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">stopAnimation</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">cancelAnimationFrame</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">animationId</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// åœæ­¢åŠ¨ç”»</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="ä¸»è¦ç‰¹ç‚¹" tabindex="-1">ä¸»è¦ç‰¹ç‚¹ <a class="header-anchor" href="#ä¸»è¦ç‰¹ç‚¹" aria-label="Permalink to &quot;ä¸»è¦ç‰¹ç‚¹&quot;">â€‹</a></h3><ul><li><p><strong>èŠ‚èƒ½é«˜æ•ˆ</strong>ï¼š <code>requestAnimationFrame</code> æ˜¯ç”±æµè§ˆå™¨æ¥å†³å®šå›è°ƒå‡½æ•°çš„æ‰§è¡Œæ—¶æœºï¼Œé€šå¸¸ä¸æ˜¾ç¤ºå™¨çš„åˆ·æ–°é¢‘ç‡ç›¸åŒ¹é…ï¼ˆä¾‹å¦‚æ¯ç§’ 60 å¸§ï¼Œ60Hz æ˜¾ç¤ºå™¨ï¼‰ã€‚è¿™é¿å…äº†ä¸å¿…è¦çš„é‡ç»˜ï¼Œé™ä½äº† CPU å’Œ GPU çš„å¼€é”€ã€‚</p></li><li><p><strong>é¿å…å¤šä½™çš„é‡ç»˜</strong>ï¼š å¦‚æœé¡µé¢å½“å‰å¤„äºåå°æ ‡ç­¾é¡µæˆ–æœªæ˜¾ç¤ºçŠ¶æ€ï¼Œ<code>requestAnimationFrame</code> ä¼šæš‚åœå›è°ƒï¼Œä»è€ŒèŠ‚çœç³»ç»Ÿèµ„æºã€‚è€Œ <code>setTimeout</code> æˆ– <code>setInterval</code> åˆ™ä¼šç»§ç»­æ‰§è¡ŒåŠ¨ç”»ï¼Œå³ä½¿ç”¨æˆ·çœ‹ä¸åˆ°å˜åŒ–ã€‚</p></li><li><p><strong>å¸§åŒæ­¥</strong>ï¼š<code>requestAnimationFrame</code> å…è®¸åŠ¨ç”»ä¸æµè§ˆå™¨çš„åˆ·æ–°é¢‘ç‡ä¿æŒåŒæ­¥ï¼Œä»è€Œä½¿åŠ¨ç”»æ›´åŠ å¹³æ»‘ã€‚</p></li></ul><h3 id="requestanimationframe-vs-settimeout-setinterval" tabindex="-1"><code>requestAnimationFrame</code> vs <code>setTimeout</code>/<code>setInterval</code> <a class="header-anchor" href="#requestanimationframe-vs-settimeout-setinterval" aria-label="Permalink to &quot;\`requestAnimationFrame\` vs \`setTimeout\`/\`setInterval\`&quot;">â€‹</a></h3><ul><li><p><strong>ç²¾åº¦</strong>ï¼š<code>requestAnimationFrame</code> èƒ½å¤Ÿæ ¹æ®æµè§ˆå™¨çš„åˆ·æ–°ç‡ç²¾ç¡®åŒæ­¥åŠ¨ç”»å¸§ï¼Œè€Œ <code>setTimeout</code>/<code>setInterval</code> ä¾èµ–äº <code>JavaScript</code> å¼•æ“çš„å®šæ—¶æœºåˆ¶ï¼Œå¯èƒ½ä¼šä¸å¤Ÿç²¾ç¡®ã€‚</p></li><li><p><strong>èŠ‚èƒ½</strong>ï¼šå½“é¡µé¢ä¸åœ¨å‰å°æ˜¾ç¤ºæ—¶ï¼Œ<code>requestAnimationFrame</code> ä¼šè‡ªåŠ¨æš‚åœæ‰§è¡Œï¼Œä»è€ŒèŠ‚çœ <code>CPU</code> èµ„æºï¼›è€Œ <code>setTimeout</code> å’Œ <code>setInterval</code> ä»ç„¶ä¼šç»§ç»­è¿è¡Œã€‚</p></li><li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š<code>requestAnimationFrame</code> å†…ç½®æ€§èƒ½ä¼˜åŒ–æœºåˆ¶ï¼Œä¸æµè§ˆå™¨çš„æ¸²æŸ“å‘¨æœŸç´§å¯†ç»“åˆï¼Œé¿å…äº†ä¸å¿…è¦çš„æ¸²æŸ“å’Œè®¡ç®—ï¼Œä»è€Œæé«˜äº†æ€§èƒ½å’ŒåŠ¨ç”»æµç•…åº¦ã€‚</p></li></ul><h2 id="messagechannel" tabindex="-1"><code>MessageChannel</code> <a class="header-anchor" href="#messagechannel" aria-label="Permalink to &quot;\`MessageChannel\`&quot;">â€‹</a></h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/MessageChannel" target="_blank" rel="noreferrer"><u>MDN MessageChannel API ğŸš€</u></a></p><p><code>MessageChannel</code> æ˜¯ <code>Web API</code> ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæä¾›äº†ä¸€ç§åœ¨ä¸åŒçš„æµè§ˆä¸Šä¸‹æ–‡ï¼ˆå¦‚ä¸åŒçš„ <code>window</code>ã€<code>iframe</code>ã€<code>worker</code> ç­‰ï¼‰ä¹‹é—´ä¼ é€’æ¶ˆæ¯çš„æ–¹å¼ã€‚å®ƒå…è®¸ä¸¤ä¸ªç‹¬ç«‹çš„ç¯å¢ƒä¹‹é—´å»ºç«‹ä¸€ä¸ªåŒå‘é€šä¿¡é€šé“ï¼Œä½¿ç”¨ <code>MessageChannel</code> çš„ä¸¤ä¸ª <code>MessagePort</code> å¯¹è±¡æ¥å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚</p><h3 id="messagechannel-çš„æ„æˆ" tabindex="-1"><code>MessageChannel</code> çš„æ„æˆ <a class="header-anchor" href="#messagechannel-çš„æ„æˆ" aria-label="Permalink to &quot;\`MessageChannel\` çš„æ„æˆ&quot;">â€‹</a></h3><ul><li><p><strong><code>MessageChannel</code></strong>ï¼šè¿™æ˜¯ä¸»è¦çš„å¯¹è±¡ï¼Œç”¨æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„æ¶ˆæ¯é€šé“ã€‚</p></li><li><p><strong><code>MessagePort</code></strong>ï¼šå½“ä½ åˆ›å»ºä¸€ä¸ª <code>MessageChannel</code> å¯¹è±¡æ—¶ï¼Œå®ƒä¼šç”Ÿæˆä¸¤ä¸ª <code>MessagePort</code> å¯¹è±¡ã€‚ä¸¤ä¸ªç«¯å£å¯¹è±¡å¯ä»¥åˆ†åˆ«å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚å®ƒä»¬é€šè¿‡ <code>postMessage</code> æ–¹æ³•å‘é€æ¶ˆæ¯ï¼Œä½¿ç”¨ <code>onmessage</code> äº‹ä»¶å¤„ç†ç¨‹åºæ¥æ”¶æ¶ˆæ¯ã€‚</p></li><li><p><strong><code>postMessage</code></strong>ï¼šä½¿ç”¨ <code>postMessage</code> æ–¹æ³•å‘é€æ¶ˆæ¯åˆ°å¦ä¸€ç«¯çš„ <code>MessagePort</code>ã€‚</p></li><li><p><strong><code>onmessage</code></strong>ï¼šç”¨äºæ¥æ”¶æ¶ˆæ¯çš„äº‹ä»¶å¤„ç†ç¨‹åºã€‚</p></li></ul><blockquote><p>ä¸¾ä¸ªä¾‹å­ ğŸŒ°</p></blockquote><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ–°çš„ MessageChannel å®ä¾‹</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> channel </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">MessageChannel</span><span style="color:#BABED8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// è·å–ä¸¤ä¸ª MessagePort</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> port1 </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> channel</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">port1</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> port2 </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> channel</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">port2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// ç›‘å¬ port1 çš„æ¶ˆæ¯</span></span>
<span class="line"><span style="color:#BABED8;">port1</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onmessage</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">event</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Message received at port1:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">event</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">data</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// ç›‘å¬ port2 çš„æ¶ˆæ¯</span></span>
<span class="line"><span style="color:#BABED8;">port2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onmessage</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">event</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Message received at port2:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">event</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">data</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// ä½¿ç”¨ postMessage å‘é€æ¶ˆæ¯</span></span>
<span class="line"><span style="color:#BABED8;">port1</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">postMessage</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Hello from port1!</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#BABED8;">port2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">postMessage</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Hello from port2!</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><blockquote><p>è¾“å‡º</p></blockquote><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">Message</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">received</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">at</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">port1:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">Hello</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">from</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">port2!</span></span>
<span class="line"><span style="color:#FFCB6B;">Message</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">received</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">at</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">port2:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">Hello</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">from</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">port1!</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="ä¸»è¦ç‰¹ç‚¹-1" tabindex="-1">ä¸»è¦ç‰¹ç‚¹ <a class="header-anchor" href="#ä¸»è¦ç‰¹ç‚¹-1" aria-label="Permalink to &quot;ä¸»è¦ç‰¹ç‚¹&quot;">â€‹</a></h3><ul><li><strong>åŒå‘é€šä¿¡</strong>ï¼šæ¯ä¸ª <code>MessagePort</code> å¯ä»¥åŒæ—¶å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚</li><li><strong>è·¨ä¸Šä¸‹æ–‡</strong>ï¼šå¯ä»¥åœ¨ä¸åŒçš„æµè§ˆå™¨ä¸Šä¸‹æ–‡ä¹‹é—´ï¼ˆå¦‚ <code>window</code>ã€<code>iframe</code>ã€<code>web worker</code>ï¼‰è¿›è¡Œé€šä¿¡ã€‚</li><li><strong>æ— å‰¯ä½œç”¨çš„é€šä¿¡</strong>ï¼šä¸ <code>DOM</code> æ²¡æœ‰ç›´æ¥çš„å…³ç³»ï¼Œæ¶ˆæ¯ä¼ é€’æœºåˆ¶æ˜¯ç‹¬ç«‹çš„ï¼Œé¿å…äº†æ€§èƒ½å¼€é”€ã€‚</li></ul><h3 id="messagechannel-å’Œ-postmessage-çš„åŒºåˆ«" tabindex="-1"><code>MessageChannel</code> å’Œ <code>postMessage</code> çš„åŒºåˆ« <a class="header-anchor" href="#messagechannel-å’Œ-postmessage-çš„åŒºåˆ«" aria-label="Permalink to &quot;\`MessageChannel\` å’Œ \`postMessage\` çš„åŒºåˆ«&quot;">â€‹</a></h3><ul><li><code>postMessage</code> æ˜¯å…¨å±€çš„è·¨ä¸Šä¸‹æ–‡é€šä¿¡æ–¹å¼ï¼Œå…è®¸é¡µé¢ä¸åŒæºæˆ–è·¨åŸŸçš„ <code>iframe</code> ä»¥åŠåŒåŸŸçš„ worker ä¹‹é—´é€šä¿¡ã€‚</li><li><code>MessageChannel</code> æä¾›çš„æ˜¯ç‹¬ç«‹çš„ã€åŸºäº <code>MessagePort</code> çš„åŒå‘é€šä¿¡é€šé“ï¼Œå¯ä»¥é€šè¿‡ä¼ é€’ <code>MessagePort</code> å¯¹è±¡ï¼Œåœ¨å¤šä¸ªä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ã€‚</li></ul>`,37)]))}const b=n(e,[["render",o]]);export{D as __pageData,b as default};
