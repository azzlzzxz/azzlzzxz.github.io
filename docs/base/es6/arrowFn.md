# ç®­å¤´å‡½æ•°

## ä»€ä¹ˆæ˜¯ç®­å¤´å‡½æ•°

ç®­å¤´å‡½æ•°æ˜¯ Es6 æ–°å¢žçš„ä¸€ç§å®šä¹‰å‡½æ•°è¡¨è¾¾å¼çš„è¯­æ³•ï¼Œå®ƒç®€åŒ–äº†æˆ‘ä»¬ä¹‹å‰å†™çš„å‡½æ•°ä¹¦å†™æ–¹å¼ï¼Œç®­å¤´å‡½æ•°å®žä¾‹åŒ–çš„å‡½æ•°å¯¹è±¡ä¸Žæˆ‘ä»¬ Es5 ä¹‹å‰åˆ›å»ºçš„å‡½æ•°è¡¨è¾¾å¼çš„åˆ›å»ºå‡½æ•°è¡Œä¸ºæ˜¯ç›¸åŒçš„ã€‚åœ¨ä»»ä½•ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼çš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚

## ç®­å¤´å‡½æ•°ä¸Žæ™®é€šå‡½æ•°æœ‰å“ªäº›åŒºåˆ«

### ç®­å¤´å‡½æ•°çš„ this æŒ‡å‘è§„åˆ™

1. ç®­å¤´å‡½æ•°æ²¡æœ‰ prototype(åŽŸåž‹)ï¼Œæ‰€ä»¥ç®­å¤´å‡½æ•°æœ¬èº«æ²¡æœ‰ this

```js
let sg = () => {}
console.log(sg.prototype) // undefined
```

2. ç®­å¤´å‡½æ•°çš„ this æŒ‡å‘åœ¨å®šä¹‰çš„æ—¶å€™ç»§æ‰¿è‡ªå¤–å±‚ç¬¬ä¸€ä¸ªæ™®é€šå‡½æ•°çš„ this

ä¸€ä¸ªå‡½æ•°ä¸­å®šä¹‰ç®­å¤´å‡½æ•°ï¼Œç„¶åŽåœ¨å¦ä¸€ä¸ªå‡½æ•°ä¸­æ‰§è¡Œç®­å¤´å‡½æ•°ã€‚

```js
let a,
  barObj = { msg: 'barçš„thisæŒ‡å‘' }

fooObj = { msg: 'fooçš„thisæŒ‡å‘' }

bar.call(barObj) // å°†barçš„thisæŒ‡å‘barObj
foo.call(fooObj) // å°†fooçš„thisæŒ‡å‘fooObj

function foo() {
  a() // ç»“æžœï¼š{ msg: 'barçš„thisæŒ‡å‘' }
}

function bar() {
  a = () => {
    console.log(this, 'thisæŒ‡å‘å®šä¹‰çš„æ—¶å€™å¤–å±‚ç¬¬ä¸€ä¸ªæ™®é€šå‡½æ•°') //
  } // åœ¨barä¸­å®šä¹‰ thisç»§æ‰¿äºŽbarå‡½æ•°çš„thisæŒ‡å‘
}
```

ä»Žä¸Šé¢ ðŸŒ° ä¸­å¯ä»¥å¾—å‡ºä¸¤ç‚¹ï¼š

- ç®­å¤´å‡½æ•°çš„ this æŒ‡å‘å®šä¹‰æ—¶æ‰€åœ¨çš„å¤–å±‚ç¬¬ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œè·Ÿä½¿ç”¨ä½ç½®æ²¡æœ‰å…³ç³»ã€‚
- è¢«ç»§æ‰¿çš„æ™®é€šå‡½æ•°çš„ this æŒ‡å‘æ”¹å˜ï¼Œç®­å¤´å‡½æ•°çš„ this æŒ‡å‘ä¼šè·Ÿç€æ”¹å˜

3. ä¸èƒ½ç›´æŽ¥ä¿®æ”¹ç®­å¤´å‡½æ•°çš„ this æŒ‡å‘

ä¸Šä¸ªæ —å­ä¸­çš„ foo å‡½æ•°ä¿®æ”¹ä¸€ä¸‹ï¼Œå°è¯•ç›´æŽ¥ä¿®æ”¹ç®­å¤´å‡½æ•°çš„ this æŒ‡å‘ã€‚

```js
let fnObj = { msg: 'å°è¯•ç›´æŽ¥ä¿®æ”¹ç®­å¤´å‡½æ•°çš„thisæŒ‡å‘' }

function foo() {
  a.call(fnObj) // ç»“æžœï¼š{ msg: 'barçš„thisæŒ‡å‘' }
}
```

å¾ˆæ˜Žæ˜¾ï¼Œcall æ˜¾ç¤ºç»‘å®š this æŒ‡å‘å¤±è´¥äº†ï¼ŒåŒ…æ‹¬ applyã€bind éƒ½ä¸€æ ·ã€‚

> å®ƒä»¬(callã€aaplyã€bind)ä¼šé»˜è®¤å¿½ç•¥ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä½†æ˜¯å¯ä»¥æ­£å¸¸ä¼ å‚ã€‚

ç„¶åŽæˆ‘åˆé€šè¿‡éšå¼ç»‘å®šæ¥å°è¯•åŒæ ·ä¹Ÿå¤±è´¥äº†ï¼Œnew è°ƒç”¨ä¼šæŠ¥é”™ï¼Œæ‰€æœ‰ï¼Œç®­å¤´å‡½æ•°ä¸èƒ½ç›´æŽ¥ä¿®æ”¹å®ƒçš„ this æŒ‡å‘ã€‚

ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é—´æŽ¥çš„å½¢å¼æ¥ä¿®æ”¹ç®­å¤´å‡½æ•°çš„æŒ‡å‘ï¼š

åŽ»ä¿®æ”¹è¢«ç»§æ‰¿çš„æ™®é€šå‡½æ•°çš„ this æŒ‡å‘ï¼Œç„¶åŽç®­å¤´å‡½æ•°çš„ this æŒ‡å‘ä¹Ÿä¼šè·Ÿç€æ”¹å˜ï¼Œè¿™åœ¨ä¸Šä¸€ä¸ªæ —å­ä¸­æœ‰æ¼”ç¤ºã€‚

```js
// å°†baræ™®é€šå‡½æ•°çš„thisæŒ‡å‘barObj ç„¶åŽå†…éƒ¨çš„ç®­å¤´å‡½æ•°ä¹Ÿä¼šæŒ‡å‘barObj

bar.call(barObj)
```

4. ç®­å¤´å‡½æ•°å¤–å±‚æ²¡æœ‰æ™®é€šå‡½æ•°ï¼Œä¸¥æ ¼æ¨¡å¼å’Œéžä¸¥æ ¼æ¨¡å¼ä¸‹å®ƒçš„ this éƒ½ä¼šæŒ‡å‘ window(å…¨å±€å¯¹è±¡)

æ—¢ç„¶ç®­å¤´å‡½æ•°çš„ this æŒ‡å‘åœ¨å®šä¹‰çš„æ—¶å€™ç»§æ‰¿è‡ªå¤–å±‚ç¬¬ä¸€ä¸ªæ™®é€šå‡½æ•°çš„ thisï¼Œé‚£ä¹ˆå½“ç®­å¤´å‡½æ•°å¤–å±‚æ²¡æœ‰æ™®é€šå‡½æ•°ï¼Œå®ƒçš„ this ä¼šæŒ‡å‘å“ªé‡Œï¼Ÿ

è¿™é‡Œè·Ÿæˆ‘ä¹‹å‰å†™çš„ this ç»‘å®šè§„åˆ™ä¸å¤ªä¸€æ ·(ä¸æ‡‚çš„å¯ä»¥ç‚¹è¿›åŽ»çœ‹ä¸€ä¸‹),æ™®é€šå‡½æ•°çš„é»˜è®¤ç»‘å®šè§„åˆ™æ˜¯ï¼š

- åœ¨éžä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œé»˜è®¤ç»‘å®šçš„ this æŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹ this æŒ‡å‘ undefined
- å¦‚æžœç®­å¤´å‡½æ•°å¤–å±‚æ²¡æœ‰æ™®é€šå‡½æ•°ç»§æ‰¿ï¼Œå®ƒ this æŒ‡å‘çš„è§„åˆ™ï¼šç®­å¤´å‡½æ•°åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹ï¼Œä¸¥æ ¼æ¨¡å¼å’Œéžä¸¥æ ¼æ¨¡å¼ä¸‹å®ƒçš„ this éƒ½ä¼šæŒ‡å‘ window(å…¨å±€å¯¹è±¡)ã€‚

ä¸¥æ ¼æ¨¡å¼åœ¨ä¸­é€”å£°æ˜Žæ— æ•ˆï¼Œå¿…é¡»åœ¨å…¨å±€/å‡½æ•°çš„å¼€å¤´å£°æ˜Žæ‰ä¼šç”Ÿæ•ˆï¼š

```js
a = 1
;('use strict') // ä¸¥æ ¼æ¨¡å¼æ— æ•ˆ å¿…é¡»åœ¨ä¸€å¼€å§‹å°±å£°æ˜Žä¸¥æ ¼æ¨¡å¼

b = 2 // ä¸æŠ¥é”™
```

### ç®­å¤´å‡½æ•°çš„ arguments

1. ç®­å¤´å‡½æ•°çš„ this æŒ‡å‘å…¨å±€ï¼Œä½¿ç”¨ arguments ä¼šæŠ¥æœªå£°æ˜Žçš„é”™è¯¯

å¦‚æžœç®­å¤´å‡½æ•°çš„ this æŒ‡å‘ window(å…¨å±€å¯¹è±¡)ä½¿ç”¨ arguments ä¼šæŠ¥é”™ï¼Œæœªå£°æ˜Ž argumentsã€‚

```js
let b = () => {
  console.log(arguments)
}

b(1, 2, 3, 4)

Uncaught ReferenceError: arguments is not defined
```
