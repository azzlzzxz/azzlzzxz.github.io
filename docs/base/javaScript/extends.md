# ç»§æ‰¿

`JavaScript`ä¸­çš„ç»§æ‰¿ä¸»è¦æ˜¯é€šè¿‡**åŸå‹é“¾**å®ç°çš„ï¼Œè€Œä» ES6 å¼€å§‹ï¼Œå¼•å…¥äº†ç±»ï¼ˆ`class`ï¼‰çš„è¯­æ³•ç³–ï¼Œä½¿å¾—ç»§æ‰¿æ›´åŠ ç›´è§‚å’Œæ˜“äºç†è§£ã€‚è™½ç„¶è¯­æ³•ä¸Šæœ‰äº†ç±»çš„æ¦‚å¿µï¼Œä½†åº•å±‚ä»ç„¶ä¾èµ–äºåŸå‹ç»§æ‰¿æœºåˆ¶ã€‚

## åŸºäºåŸå‹çš„ç»§æ‰¿

åœ¨`JavaScript`ä¸­ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªéšå¼çš„å±æ€§ï¼Œç§°ä¸º `[[Prototype]]`ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ `__proto__` æ¥è®¿é—®å®ƒï¼ˆå®é™…ä¸Š `__proto__` æ˜¯æµè§ˆå™¨æä¾›çš„éæ ‡å‡†å±æ€§ï¼‰ã€‚å½“æˆ‘ä»¬è¯•å›¾è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œ`JavaScript`ä¼šé¦–å…ˆæŸ¥æ‰¾è¯¥å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™ä¼šæ²¿ç€åŸå‹é“¾ç»§ç»­æŸ¥æ‰¾ã€‚

### åŸå‹é“¾ç»§æ‰¿

JavaScript çš„ç»§æ‰¿æœºåˆ¶ä¾èµ–äºåŸå‹é“¾ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡çš„åŸå‹ä¹Ÿæœ‰ä¸€ä¸ªåŸå‹ï¼Œé‚£ä¹ˆå½“è®¿é—®å¯¹è±¡çš„å±æ€§æ—¶ï¼ŒJavaScript ä¼šæ²¿ç€åŸå‹é“¾ä¸€ç›´æŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°å±æ€§æˆ–è¾¾åˆ°é“¾çš„é¡¶ç«¯ï¼ˆå³ `Object.prototype`ï¼‰ã€‚

åœ¨è¿™ç§ç»§æ‰¿æ–¹å¼ä¸­ï¼Œæˆ‘ä»¬è®©å­ç±»çš„ `prototype` æŒ‡å‘çˆ¶ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œä»è€Œä½¿å­ç±»å¯ä»¥è®¿é—®çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚

> ä¸¾ä¸ª ğŸŒ°

```js
function Parent() {
  this.name = 'Parent'
  this.colors = ['red', 'blue', 'green']
}

Parent.prototype.getName = function () {
  console.log(this.name)
}

function Child() {}

Child.prototype = new Parent() // å­ç±»çš„åŸå‹æŒ‡å‘çˆ¶ç±»çš„å®ä¾‹

const child1 = new Child()
child1.getName() // è¾“å‡º 'Parent'
```

::: info ç‰¹ç‚¹

- å­ç±»èƒ½å¤Ÿè®¿é—®çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•å’Œå±æ€§ã€‚

- æ‰€æœ‰å®ä¾‹å…±äº«çˆ¶ç±»çš„å¼•ç”¨ç±»å‹å±æ€§ï¼ˆä¾‹å¦‚æ•°ç»„ã€å¯¹è±¡ï¼‰ï¼Œå¯¼è‡´ä¸€ä¸ªå®ä¾‹ä¿®æ”¹å±æ€§ä¼šå½±å“æ‰€æœ‰å®ä¾‹ã€‚
  :::

::: tip ç¼ºç‚¹

- å¼•ç”¨ç±»å‹å±æ€§å…±äº«ï¼šå¦‚æœçˆ¶ç±»ä¸­æœ‰å¼•ç”¨ç±»å‹çš„å±æ€§ï¼Œå¦‚æ•°ç»„æˆ–å¯¹è±¡ï¼Œå­ç±»çš„æ‰€æœ‰å®ä¾‹ä¼šå…±äº«è¿™äº›å±æ€§ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å®ä¾‹ä¹‹é—´ç›¸äº’å½±å“ã€‚

- æ— æ³•å‘çˆ¶ç±»æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ï¼šåœ¨ç»§æ‰¿æ—¶ï¼Œæ— æ³•å‘çˆ¶ç±»æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ã€‚
  :::

### æ„é€ å‡½æ•°ç»§æ‰¿

æ„é€ å‡½æ•°ç»§æ‰¿çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œåœ¨å­ç±»çš„æ„é€ å‡½æ•°å†…éƒ¨ä½¿ç”¨ `call` æˆ– `apply` æ–¹æ³•è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œä»è€Œä½¿å¾—å­ç±»èƒ½å¤Ÿç»§æ‰¿çˆ¶ç±»çš„å±æ€§ã€‚æ„é€ å‡½æ•°ç»§æ‰¿åªç»§æ‰¿çˆ¶ç±»æ„é€ å‡½æ•°ä¸­çš„å±æ€§ï¼Œä¸ä¼šç»§æ‰¿çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•

> ä¸¾ä¸ª ğŸŒ°

```js
function Parent(name) {
  this.name = name
  this.colors = ['red', 'blue', 'green']
}

function Child(name, age) {
  Parent.call(this, name) // è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
  this.age = age
}

const child1 = new Child('Child1', 18)
console.log(child1.name) // è¾“å‡º 'Child1'
console.log(child1.colors) // è¾“å‡º ['red', 'blue', 'green']

const child2 = new Child('Child2', 20)
child2.colors.push('black')
console.log(child1.colors) // ['red', 'blue', 'green']
console.log(child2.colors) // ['red', 'blue', 'green', 'black']
```

::: info ç‰¹ç‚¹

- é€šè¿‡ `Parent.call(this, name)` è¿™ç§æ–¹å¼ï¼Œå­ç±»å¯ä»¥ç›´æ¥è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œå¹¶ç»™çˆ¶ç±»æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ã€‚

- å­ç±»çš„æ¯ä¸ªå®ä¾‹éƒ½ä¼šæœ‰ç‹¬ç«‹çš„çˆ¶ç±»å±æ€§ï¼ˆåŒ…æ‹¬å¼•ç”¨ç±»å‹å±æ€§ï¼‰ï¼Œä¸ä¼šå…±äº«å¼•ç”¨ç±»å‹å±æ€§ã€‚
  :::

::: tip ä¼˜ç‚¹

- è§£å†³äº†å¼•ç”¨ç±»å‹å±æ€§å…±äº«çš„é—®é¢˜ï¼šæ¯ä¸ªå®ä¾‹éƒ½å¯ä»¥ç‹¬ç«‹æ‹¥æœ‰çˆ¶ç±»ä¸­çš„å¼•ç”¨ç±»å‹å±æ€§ï¼ˆå¦‚æ•°ç»„ã€å¯¹è±¡ï¼‰ã€‚

- å¯ä»¥å‘çˆ¶ç±»æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ï¼Œçµæ´»æ€§æ›´é«˜ã€‚
  :::

::: tip ç¼ºç‚¹

- åªèƒ½ç»§æ‰¿çˆ¶ç±»æ„é€ å‡½æ•°ä¸­çš„å±æ€§ï¼Œæ— æ³•ç»§æ‰¿çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•ã€‚è¿™æ„å‘³ç€æ¯ä¸ªå­ç±»å®ä¾‹éƒ½æœ‰ä¸€ä»½ç‹¬ç«‹çš„çˆ¶ç±»å±æ€§å‰¯æœ¬ï¼Œä½†æ²¡æœ‰åŠæ³•è®¿é—®çˆ¶ç±»çš„å…¬å…±æ–¹æ³•ã€‚

- æ–¹æ³•ä¸èƒ½å¤ç”¨ï¼šç”±äºæ²¡æœ‰ç»§æ‰¿çˆ¶ç±»çš„åŸå‹é“¾ï¼Œå¦‚æœçˆ¶ç±»æœ‰å…¬å…±çš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ä¸ä¼šè¢«å­ç±»ç»§æ‰¿ï¼Œéœ€è¦æ‰‹åŠ¨åœ¨å­ç±»ä¸­å®šä¹‰ã€‚
  :::

### ç»„åˆç»§æ‰¿ï¼ˆä¼ªç»å…¸ç»§æ‰¿ï¼‰

ç»„åˆç»§æ‰¿æ˜¯åŸå‹é“¾ç»§æ‰¿å’Œæ„é€ å‡½æ•°ç»§æ‰¿ç›¸ç»“åˆçš„ä¸€ç§æ¨¡å¼ã€‚å®ƒæ—¢èƒ½å¤Ÿè§£å†³å¼•ç”¨ç±»å‹å±æ€§å…±äº«çš„é—®é¢˜ï¼Œåˆèƒ½å¤Ÿä¿æŒå¯¹çˆ¶ç±»åŸå‹ä¸Šæ–¹æ³•çš„å¤ç”¨ã€‚

> ä¸¾ä¸ª ğŸŒ°

```js
function Parent(name) {
  this.name = name
  this.colors = ['red', 'blue', 'green']
}

Parent.prototype.getName = function () {
  console.log(this.name)
}

function Child(name, age) {
  Parent.call(this, name) // è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œè§£å†³å¼•ç”¨ç±»å‹å±æ€§å…±äº«é—®é¢˜
  this.age = age
}

Child.prototype = new Parent() // ç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•
Child.prototype.constructor = Child

const child1 = new Child('Child1', 18)
child1.getName() // è¾“å‡º 'Child1'
console.log(child1.colors) // ['red', 'blue', 'green']

child1.colors.push('black')
console.log(child1.colors) // ['red', 'blue', 'green', 'black']

const child2 = new Child('Child2', 20)
console.log(child2.colors) // ['red', 'blue', 'green']
```

::: info ç‰¹ç‚¹

- é€šè¿‡ `Parent.call(this, name)` è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œå®ç°äº†å¯¹çˆ¶ç±»å±æ€§çš„ç‹¬ç«‹æ‹·è´ï¼Œè§£å†³äº†å¼•ç”¨ç±»å‹å±æ€§å…±äº«çš„é—®é¢˜ã€‚

- é€šè¿‡ `Child.prototype = new Parent()` å®ç°å¯¹å­ç±»åŸå‹é“¾çš„ç»§æ‰¿ï¼Œä¿è¯å­ç±»å¯ä»¥è®¿é—®çˆ¶ç±»çš„åŸå‹æ–¹æ³•ã€‚
  :::

::: tip ä¼˜ç‚¹

- è§£å†³äº†åŸå‹é“¾ç»§æ‰¿ä¸­çš„å¼•ç”¨ç±»å‹å±æ€§å…±äº«é—®é¢˜ã€‚

- é€šè¿‡ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°ç»§æ‰¿å’ŒåŸå‹ç»§æ‰¿ï¼Œä½¿å¾—æ¯ä¸ªå®ä¾‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å±æ€§ï¼ŒåŒæ—¶å…±äº«çˆ¶ç±»çš„æ–¹æ³•ã€‚
  :::

::: tip ç¼ºç‚¹

- çˆ¶ç±»æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ˜¯åœ¨å­ç±»åŸå‹ä¸Šï¼Œå¦ä¸€æ¬¡æ˜¯åœ¨å­ç±»æ„é€ å‡½æ•°ä¸­ï¼Œå¯èƒ½ä¼šé€ æˆä¸€å®šçš„æ€§èƒ½æµªè´¹ã€‚
  :::

### åŸå‹å¼ç»§æ‰¿

åŸå‹å¼ç»§æ‰¿æ˜¯ä¸€ç§ä¸ä½¿ç”¨æ„é€ å‡½æ•°çš„ç»§æ‰¿æ–¹å¼ï¼Œå®ƒé€šè¿‡ç›´æ¥åˆ›å»ºä¸€ä¸ªç°æœ‰å¯¹è±¡çš„å‰¯æœ¬æ¥å®ç°ç»§æ‰¿ã€‚è¿™ç§æ–¹å¼é€‚åˆäºåˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„æµ…æ‹·è´

> ä¸¾ä¸ª ğŸŒ°

```js
function createObject(o) {
  function F() {}
  F.prototype = o
  return new F()
}

const parent = {
  name: 'Parent',
  colors: ['red', 'blue', 'green'],
  getName: function () {
    console.log(this.name)
  },
}

const child = createObject(parent)
child.getName() // è¾“å‡º 'Parent'
```

::: info ç‰¹ç‚¹

- è¿™ç§ç»§æ‰¿æ–¹å¼é€‚ç”¨äºå¯¹è±¡çš„æµ…æ‹·è´ã€‚

- é€šè¿‡å°†çˆ¶ç±»å¯¹è±¡èµ‹å€¼ç»™å­ç±»çš„åŸå‹ï¼Œå®ç°å¯¹çˆ¶ç±»å±æ€§å’Œæ–¹æ³•çš„ç»§æ‰¿ã€‚
  :::

::: tip ç¼ºç‚¹

- å’ŒåŸå‹é“¾ç»§æ‰¿ç±»ä¼¼ï¼Œå¼•ç”¨ç±»å‹çš„å±æ€§ä»ç„¶ä¼šè¢«å…±äº«ï¼Œå®ä¾‹ä¹‹é—´å¯èƒ½ä¼šç›¸äº’å½±å“ã€‚

- ä¸èƒ½å‘çˆ¶ç±»æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ã€‚
  :::

### å¯„ç”Ÿå¼ç»§æ‰¿

å¯„ç”Ÿå¼ç»§æ‰¿æ˜¯ä¸€ç§åœ¨åŸå‹å¼ç»§æ‰¿çš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥å¯¹ç»§æ‰¿çš„å¯¹è±¡è¿›è¡Œå¢å¼ºçš„ç»§æ‰¿æ–¹å¼ã€‚å®ƒçš„åŸºæœ¬æ€è·¯æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡æ¥ç»§æ‰¿çˆ¶å¯¹è±¡ï¼Œç„¶åå¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œæ‰©å±•ã€‚

> ä¸¾ä¸ª ğŸŒ°

```js
function createObject(o) {
  function F() {}
  F.prototype = o
  return new F()
}

function createNewObject(o) {
  const clone = createObject(o)
  clone.sayHello = function () {
    console.log('Hello')
  }
  return clone
}

const parent = {
  name: 'Parent',
  colors: ['red', 'blue', 'green'],
}

const child = createNewObject(parent)
child.sayHello() // è¾“å‡º 'Hello'
```

::: info ç‰¹ç‚¹

- åŸºäºåŸå‹å¼ç»§æ‰¿çš„æ€è·¯ï¼Œåˆ›å»ºä¸€ä¸ªå‰¯æœ¬ï¼Œç„¶åå¯¹å‰¯æœ¬è¿›è¡Œå¢å¼ºï¼Œæ·»åŠ æ–°çš„æ–¹æ³•æˆ–å±æ€§ã€‚
  :::

::: tip ä¼˜ç‚¹

- å¯ä»¥é€šè¿‡è¿”å›æ–°çš„å¯¹è±¡ï¼Œé¿å…å¼•ç”¨ç±»å‹å±æ€§å…±äº«é—®é¢˜ã€‚
  :::

::: tip ç¼ºç‚¹

- å’ŒåŸå‹å¼ç»§æ‰¿ä¸€æ ·ï¼Œå¯„ç”Ÿå¼ç»§æ‰¿ä¹Ÿæ— æ³•é¿å…å¼•ç”¨ç±»å‹å±æ€§çš„å…±äº«é—®é¢˜ã€‚

- ç”±äºæ²¡æœ‰ä½¿ç”¨ä¸¥æ ¼çš„æ„é€ å‡½æ•°ç»§æ‰¿ï¼Œè¿™ç§ç»§æ‰¿æ–¹å¼æ¯”è¾ƒä½æ•ˆï¼Œæ— æ³•å¤ç”¨æ–¹æ³•ã€‚
  :::

### å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿

å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿æ˜¯ `JavaScript` ä¸­æœ€æ¨èçš„ä¸€ç§ç»§æ‰¿æ–¹å¼ã€‚å®ƒç»“åˆäº†ç»„åˆç»§æ‰¿çš„ä¼˜ç‚¹ï¼Œå¹¶ä¸”é¿å…äº†ç»„åˆç»§æ‰¿ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ä¸¤æ¬¡çš„æ€§èƒ½é—®é¢˜ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ åŸå‹é“¾ å®ç°æ–¹æ³•ç»§æ‰¿ï¼Œé€šè¿‡ æ„é€ å‡½æ•° å®ç°å±æ€§ç»§æ‰¿ã€‚

> ä¸¾ä¸ª ğŸŒ°

```js
function Parent(name) {
  this.name = name
  this.colors = ['red', 'blue', 'green']
}

Parent.prototype.getName = function () {
  console.log(this.name)
}

function Child(name, age) {
  Parent.call(this, name) // å±æ€§ç»§æ‰¿
  this.age = age
}

function inheritPrototype(child, parent) {
  const prototype = Object.create(parent.prototype) // åˆ›å»ºçˆ¶ç±»åŸå‹çš„å‰¯æœ¬
  prototype.constructor = child // ä¿®æ­£ constructor æŒ‡å‘
  child.prototype = prototype // èµ‹å€¼ç»™å­ç±»çš„åŸå‹
}

inheritPrototype(Child, Parent)

const child1 = new Child('Child1', 18)
child1.getName() // è¾“å‡º 'Child1'
```

::: info ç‰¹ç‚¹

- åªè°ƒç”¨ä¸€æ¬¡çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œé¿å…äº†ç»„åˆç»§æ‰¿ä¸­çš„æ€§èƒ½æµªè´¹ã€‚

- å­ç±»çš„å®ä¾‹å¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„å±æ€§ï¼ˆé€šè¿‡æ„é€ å‡½æ•°ç»§æ‰¿ï¼‰å’Œæ–¹æ³•ï¼ˆé€šè¿‡åŸå‹é“¾ç»§æ‰¿ï¼‰ã€‚

- é€šè¿‡ `Object.create()` æ¥åˆ›å»ºçˆ¶ç±»åŸå‹çš„å‰¯æœ¬ï¼Œé¿å…ç›´æ¥ä¿®æ”¹çˆ¶ç±»çš„åŸå‹
  :::

::: tip ä¼˜ç‚¹

- é«˜æ•ˆä¸”çµæ´»ï¼šåªè°ƒç”¨ä¸€æ¬¡çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œæ—¢èƒ½é¿å…ç»„åˆç»§æ‰¿ä¸­çš„é‡å¤è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œåˆèƒ½ä¿æŒå¯¹åŸå‹é“¾çš„ç»§æ‰¿ã€‚

- é¿å…å¼•ç”¨ç±»å‹å…±äº«é—®é¢˜ï¼šé€šè¿‡æ„é€ å‡½æ•°ç»§æ‰¿çˆ¶ç±»çš„å±æ€§ï¼Œä¿è¯æ¯ä¸ªå®ä¾‹æœ‰è‡ªå·±çš„å‰¯æœ¬ã€‚
  :::

::: tip ç¼ºç‚¹

- å®ç°è¿‡ç¨‹ç¨å¾®å¤æ‚ä¸€äº›
  :::

## ES6 ç±»ç»§æ‰¿

è™½ç„¶ ES6 å¼•å…¥äº† `class` å…³é”®å­—æ¥ç®€åŒ–ç»§æ‰¿çš„è¯­æ³•ï¼Œä½†å®ƒçš„åº•å±‚å®ç°ä»ç„¶æ˜¯åŸºäºåŸå‹é“¾çš„ã€‚`class` åªæ˜¯è¯­æ³•ç³–ï¼Œä½¿å¾—ç»§æ‰¿çš„å®ç°æ–¹å¼æ›´åŠ æ¸…æ™°ã€‚

### åŸºæœ¬ç±»å®šä¹‰å’Œç»§æ‰¿

ES6 ä¸­çš„ç±»å®šä¹‰å¯ä»¥é€šè¿‡ `class` å…³é”®å­—æ¥åˆ›å»ºï¼Œå¹¶ä½¿ç”¨ `extends` å…³é”®å­—æ¥å®ç°ç»§æ‰¿ã€‚`super` å…³é”®å­—ç”¨äºè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°æˆ–æ–¹æ³•ã€‚

> ä¸¾ä¸ª ğŸŒ°

```js
class Animal {
  constructor(name) {
    this.name = name
  }

  speak() {
    console.log(`${this.name} makes a noise.`)
  }
}

class Dog extends Animal {
  constructor(name, breed) {
    super(name) // è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°
    this.breed = breed
  }

  speak() {
    console.log(`${this.name} barks.`)
  }
}

const labrador = new Dog('Buddy', 'Labrador')
labrador.speak() // è¾“å‡º: "Buddy barks."
```

åœ¨ ğŸ‘† çš„ä¾‹å­ä¸­ï¼š

- `Animal` æ˜¯ä¸€ä¸ªåŸºç±»ï¼ˆçˆ¶ç±»ï¼‰ã€‚
- `Dog` æ˜¯ `Animal` çš„å­ç±»ï¼Œé€šè¿‡ `extends` å…³é”®å­—å®ç°ç»§æ‰¿ã€‚
- `super(name)` è°ƒç”¨äº†çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œä»è€Œç»§æ‰¿äº† `name` å±æ€§ã€‚
- `Dog` é‡å†™äº†çˆ¶ç±»çš„ `speak` æ–¹æ³•ã€‚

### é™æ€æ–¹æ³•ç»§æ‰¿

ES6 ç±»å¯ä»¥å®šä¹‰é™æ€æ–¹æ³•ï¼ˆä½¿ç”¨ `static` å…³é”®å­—ï¼‰ï¼Œé™æ€æ–¹æ³•ä¸ä¼šè¢«å®ä¾‹ç»§æ‰¿ï¼Œè€Œæ˜¯ç›´æ¥ç”±ç±»è°ƒç”¨ã€‚å¦‚æœå­ç±»å®šä¹‰äº†é™æ€æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ `super` è°ƒç”¨çˆ¶ç±»çš„é™æ€æ–¹æ³•ã€‚

> ä¸¾ä¸ª ğŸŒ°

```js
class Animal {
  constructor(name) {
    this.name = name
  }

  static species() {
    return 'Generic Animal'
  }
}

class Dog extends Animal {
  constructor(name, breed) {
    super(name)
    this.breed = breed
  }

  static species() {
    return super.species() + ' (Dog)'
  }
}

console.log(Animal.species()) // è¾“å‡º: "Generic Animal"
console.log(Dog.species()) // è¾“å‡º: "Generic Animal (Dog)"
```

åœ¨ ğŸ‘† çš„ä¾‹å­ä¸­ï¼š

- `Animal` å’Œ `Dog` éƒ½æœ‰é™æ€æ–¹æ³• `species`ã€‚
- `Dog.species()` é€šè¿‡ `super.species()` è°ƒç”¨äº† `Animal` çš„é™æ€æ–¹æ³•ã€‚

### `Object.getPrototypeOf()`

`Object.getPrototypeOf()`æ–¹æ³•å¯ä»¥ç”¨æ¥ä»å­ç±»ä¸Šè·å–çˆ¶ç±»

```js
class Point {
  /*...*/
}

class ColorPoint extends Point {
  /*...*/
}

Object.getPrototypeOf(ColorPoint) === Point
// true
```

å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•åˆ¤æ–­ï¼Œä¸€ä¸ªç±»æ˜¯å¦ç»§æ‰¿äº†å¦ä¸€ä¸ªç±»ã€‚

### `super` å…³é”®å­—

- `super` ä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶ï¼Œä»£è¡¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œ`ES6` è¦æ±‚ï¼Œå­ç±»çš„æ„é€ å‡½æ•°å¿…é¡»æ‰§è¡Œä¸€æ¬¡`super()`å‡½æ•°

- `super`ä½œä¸ºå¯¹è±¡æ—¶ï¼Œåœ¨æ™®é€šæ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼Œåœ¨é™æ€æ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»

#### `super` ä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶ï¼Œä»£è¡¨çˆ¶ç±»çš„æ„é€ å‡½æ•°

```js
class A {}

class B extends A {
  constructor() {
    super()
  }
}
```

::: tip æ³¨æ„ âš ï¸

- è°ƒç”¨`super()`çš„ä½œç”¨æ˜¯å½¢æˆå­ç±»çš„`this`å¯¹è±¡ï¼ŒæŠŠçˆ¶ç±»çš„å®ä¾‹å±æ€§å’Œæ–¹æ³•æ”¾åˆ°è¿™ä¸ª`this`å¯¹è±¡ä¸Šé¢

- å­ç±»åœ¨è°ƒç”¨`super()`ä¹‹å‰ï¼Œæ˜¯æ²¡æœ‰`this`å¯¹è±¡çš„ï¼Œä»»ä½•å¯¹`this`çš„æ“ä½œéƒ½è¦æ”¾åœ¨`super()`çš„åé¢
  :::

```js
class A {
  constructor() {
    console.log(new.target.name)
  }
}
class B extends A {
  constructor() {
    super()
  }
}
new A() // A
new B() // B
```

ğŸ‘† çš„ä»£ç ä¸­ï¼Œ`new.target`æŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨`super()`æ‰§è¡Œæ—¶ï¼ˆ`new B()`ï¼‰ï¼Œå®ƒæŒ‡å‘çš„æ˜¯å­ç±»`B`çš„æ„é€ å‡½æ•°ï¼Œè€Œä¸æ˜¯çˆ¶ç±»`A`çš„æ„é€ å‡½æ•°ã€‚å°±è¯´æ˜äº†ï¼Œ`super()`å†…éƒ¨çš„`this`æŒ‡å‘çš„æ˜¯å­ç±»`B`ã€‚

::: tip æ³¨æ„ âš ï¸

- ç”±äº`super()`åœ¨å­ç±»æ„é€ æ–¹æ³•ä¸­æ‰§è¡Œæ—¶ï¼Œå­ç±»çš„å±æ€§å’Œæ–¹æ³•è¿˜æ²¡æœ‰ç»‘å®šåˆ°`this`ï¼Œæ‰€ä»¥å¦‚æœå­˜åœ¨åŒåå±æ€§ï¼Œæ­¤æ—¶æ‹¿åˆ°çš„æ˜¯çˆ¶ç±»çš„å±æ€§

```js
class A {
  name = 'A'
  constructor() {
    console.log('My name is ' + this.name)
  }
}

class B extends A {
  name = 'B'
}

const b = new B() // My name is A
```

ä¹Ÿå°±æ˜¯åœ¨å­ç±»`B`ï¼Œåœ¨`super()`æ—¶ï¼Œ`B`çš„`name`å±æ€§è¿˜æ²¡ç»‘å®šåˆ°`this`ä¸Šï¼Œæ‰€ä»¥`this.name`æ‹¿åˆ°çš„æ˜¯`A`çš„`name`ã€‚
:::

#### `super` ä½œä¸ºå¯¹è±¡æ—¶ï¼Œåœ¨æ™®é€šæ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼Œåœ¨é™æ€æ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»

- åœ¨æ™®é€šæ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡

```js
class A {
  p() {
    return 2
  }
}

A.prototype.name = 'steins gate'

class B extends A {
  constructor() {
    super()
    console.log(super.p()) // 2
    console.log(super.name) // steins gate
  }
}

let b = new B()
```

åœ¨å­ç±»æ™®é€šæ–¹æ³•ä¸­é€šè¿‡`super`è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œæ–¹æ³•å†…éƒ¨çš„`this`æŒ‡å‘å½“å‰çš„å­ç±»å®ä¾‹

```js
class A {
  constructor() {
    this.x = 1
  }
  print() {
    console.log(this.x)
  }
}

class B extends A {
  constructor() {
    super()
    this.x = 2
  }
  m() {
    super.print()
  }
}

let b = new B()
b.m() // 2
```

ğŸ‘† çš„ä»£ç ä¸­ï¼Œ`super.print()`è™½ç„¶è°ƒç”¨çš„æ˜¯`A.prototype.print()`ï¼Œä½†æ˜¯`A.prototype.print()`å†…éƒ¨çš„`this`æŒ‡å‘å­ç±» B çš„å®ä¾‹ï¼Œå¯¼è‡´è¾“å‡ºçš„æ˜¯`2`ï¼Œè€Œä¸æ˜¯`1`ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯`super.print.call(this)`

- å¦‚æœ`super`ä½œä¸ºå¯¹è±¡ï¼Œç”¨åœ¨é™æ€æ–¹æ³•ä¹‹ä¸­ï¼Œè¿™æ—¶`super`å°†æŒ‡å‘çˆ¶ç±»

```js
class Parent {
  static myMethod(msg) {
    console.log('static', msg)
  }

  myMethod(msg) {
    console.log('instance', msg)
  }
}

class Child extends Parent {
  static myMethod(msg) {
    super.myMethod(msg)
  }

  myMethod(msg) {
    super.myMethod(msg)
  }
}

Child.myMethod(1) // static 1

var child = new Child()
child.myMethod(2) // instance 2
```

### ç±»çš„`prototype`å±æ€§å’Œ`__proto__`å±æ€§

- å­ç±»çš„`__proto__`å±æ€§ï¼Œè¡¨ç¤ºæ„é€ å‡½æ•°çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»ã€‚

- å­ç±»`prototype`å±æ€§çš„`__proto__`å±æ€§ï¼Œè¡¨ç¤ºæ–¹æ³•çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»çš„`prototype`å±æ€§ã€‚

```js
class A {}

class B extends A {}

B.__proto__ === A // true
B.prototype.__proto__ === A.prototype // true
```

## ES6 ç±»ç»§æ‰¿ä¸åŸå‹ç»§æ‰¿çš„å¯¹æ¯”

| ç‰¹æ€§         | åŸå‹ç»§æ‰¿                                      | ES6 ç±»ç»§æ‰¿                        |
| ------------ | --------------------------------------------- | --------------------------------- |
| è¯­æ³•å¤æ‚åº¦   | éœ€è¦æ˜¾å¼åœ°æ“ä½œ `prototype` å’Œ `__proto__`     | ä½¿ç”¨ `class` å’Œ `extends` æ›´ç›´è§‚  |
| æ„é€ å‡½æ•°è°ƒç”¨ | ä½¿ç”¨ `call()` æˆ– `apply()` æ¥ç»§æ‰¿çˆ¶ç±»æ„é€ å‡½æ•° | ä½¿ç”¨ `super()` æ¥è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•° |
| æ–¹æ³•å®šä¹‰     | æ–¹æ³•æ”¾åœ¨æ„é€ å‡½æ•°çš„ `prototype` ä¸Š             | æ–¹æ³•ç›´æ¥å®šä¹‰åœ¨ `class` ä¸­         |
| é™æ€æ–¹æ³•     | åœ¨æ„é€ å‡½æ•°æœ¬èº«ä¸Šå®šä¹‰                          | ä½¿ç”¨ `static` å…³é”®å­—              |
| ç»§æ‰¿æœºåˆ¶     | é€šè¿‡åŸå‹é“¾                                    | é€šè¿‡ `class` å’Œ `extends`         |

## æ€»ç»“

- **JavaScript çš„ç»§æ‰¿**æ˜¯åŸºäºåŸå‹é“¾çš„ï¼Œæ‰€æœ‰å¯¹è±¡é€šè¿‡åŸå‹é“¾è¿›è¡Œå±æ€§å’Œæ–¹æ³•çš„ç»§æ‰¿ã€‚
- åœ¨ ES5 ä¸­ï¼Œç»§æ‰¿æ˜¯é€šè¿‡æ„é€ å‡½æ•°å’Œ `prototype` å®ç°çš„ï¼Œæ‰‹åŠ¨è®¾ç½®å­ç±»çš„åŸå‹ä¸ºçˆ¶ç±»çš„åŸå‹ã€‚
- ES6 å¼•å…¥äº† `class` è¯­æ³•ï¼Œä½¿å¾—ç»§æ‰¿çš„å†™æ³•æ›´åŠ ç›´è§‚å’Œç±»ä¼¼å…¶ä»–é¢å‘å¯¹è±¡è¯­è¨€ï¼Œä½†æœ¬è´¨ä¸Šè¿˜æ˜¯åŸºäºåŸå‹é“¾çš„ç»§æ‰¿æœºåˆ¶ã€‚
- `super` å…³é”®å­—ç”¨äºè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°å’Œæ–¹æ³•ã€‚
